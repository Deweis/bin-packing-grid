<!--
  <bin-packing-grid>

  @element bin-packing-grid
  @demo https://chris-l.github.io/bin-packing-grid/
--><html><head><template id="bin-packing-grid">
  <style>
    :host {
      display   : block;
      position  : relative;
    }
    :host ::content > bin-packing-item, :host > .bin-packing-filler, :host ::content > .bin-packing-filler {
      display   : block;
      position  : absolute;
      box-sizing: border-box;
    }
  </style>
  <content></content>
</template>

<script>!function(){"use strict";function a(a,b,c){var d,e,f,g,h;a.root=a.createShadowRoot(),d=m.querySelector("#"+b),a.root.appendChild(d.content.cloneNode(!0)),g=/<style(.|\n)*<\/style>/m,window.ShadowDOMPolyfill&&g.test(d.innerHTML)&&(h=document.createElement("head"),h.innerHTML=d.innerHTML,e=j(h.getElementsByTagName("style"),function(a){return a.innerHTML.replace(/:host/gm,c||b).replace(/::content/gm,"").trim()}).join("\n"),h=null,f=document.createElement("style"),f.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(f))}function b(a,b){function c(a){return a.replace(/([A-Z])/g,"-$1").toLowerCase()}function d(a,b){return b.type===Number?parseInt(a,10):b.type===String?String(a):a}a.props={},Object.keys(b).forEach(function(e){var f,g,h;g=b[e],f=c(e),h=g.value,"function"==typeof h&&(h=h()),null===a.getAttribute(f)&&a.setAttribute(f,a.props[e]||h),Object.defineProperty(a,e,{get:function(){return d(a.getAttribute(f),g)||a.props[e]||h},set:function(b){a.props[e]=b,a.setAttribute(f,b),"function"==typeof a[g.observer]&&a[g.observer]()}})})}function c(a,b){return document.defaultView.getComputedStyle(a,null).getPropertyValue(b)}function d(a){return a.map(function(a){return a.slice(0)})}function e(a,b,c,e,f,g){var h,i;if(b+f>g)return!1;for(a=d(a),i=c;c+e>i;i+=1)for(void 0===a[i]&&(a[i]=k()),h=b;b+f>h;h+=1){if(1===a[i][h])return!1;a[i][h]=1}return a}function f(a,b){function c(a,c){var d=document.createElement("div");b.root.appendChild(d),d.style.width=b.cellSize+"px",d.style.height=b.cellSize+"px",d.style.top=(b.cellSize+b.gutterSize)*a+"px",d.style.left=(b.cellSize+b.gutterSize)*c+"px",d.className="bin-packing-filler"}i(b.root.querySelectorAll(".bin-packing-filler"),function(a){b.root.removeChild(a)});var e,f,g;for(g=d(a),g.reverse(),e=0;e<g.length;e+=1)for(f=0;f<b.columns;f+=1)0===g[e][f]&&(0===e?g[e][f]=!1:g[e-1][f]===!1?g[e][f]=!1:c(a.length-e-1,f))}function g(a,b){var c,d;d=[k()],c=Array.prototype.slice.call(a,0),c.forEach(function(a){var c,f,g,h,i,j,k=[];for(c=0;c<d.length;c+=1)for(f=0;f<b.columns;f+=1)if(0===d[c][f]&&(g=e(d,f,c,a.rows,a.cols,b.columns),g!==!1)){j=d[c].indexOf(1,f),k.push({grid:g,left:d[c].slice(f,j),y:c,x:f});break}if(k.length>0)return k.sort(function(a,b){return a.grid.length<b.grid.length?-1:a.grid.length>b.grid.length?1:a.y<b.y?-1:a.y>b.y?1:a.x>b.x?-1:a.x<b.x?1:0}),i=k.shift(),a.item.setAttribute("top",i.y),a.item.setAttribute("left",i.x),void(d=i.grid);if(h=d.length,g=e(d,0,d.length,a.rows,a.cols,b.columns),g===!1)throw new Error("The element does not fit!");d=g,a.item.setAttribute("top",h),a.item.setAttribute("left",0)}),f(d,b),b.style.height=d.length*(b.cellSize+b.gutterSize)+"px"}function h(a){var b,d;a.style.width="auto",d=setInterval(function(){b=parseInt(c(a,"width"),10),isNaN(b)||(clearInterval(d),a.columns=function(){var c,d;return c=Math.floor(b/(a.cellSize+a.gutterSize)),d=a.elements.slice(0).sort(function(a,b){return a.rows>b.rows}).pop().rows,d>c?d:c}(),k=function(){return Array.apply(0,Array.call(0,a.columns)).map(function(){return 0})},a.style.width=a.columns*(a.cellSize+a.gutterSize)-a.gutterSize+"px",g(a.elements,a))},1)}var i,j,k,l,m,n,o,p,q;m=(document._currentScript||document.currentScript).ownerDocument,j=Function.prototype.call.bind(Array.prototype.map),i=Function.prototype.call.bind(Array.prototype.forEach),n=Object.create(HTMLElement.prototype),p={cellSize:{type:Number,value:100},gutterSize:{type:Number,value:5}},n.reflow=function(){var a,b=this;a=this.querySelectorAll("bin-packing-item"),i(a,function(a){a.gutterSize=b.gutterSize,a.baseSize=b.cellSize+b.gutterSize}),this.elements=j(a,function(a){var b,c;return b="number"==typeof a.cols?a.cols:parseInt(a.getAttribute("cols"),10)||0,c="number"==typeof a.rows?a.rows:parseInt(a.getAttribute("rows"),10)||0,{area:b*c,cols:b,rows:c,item:a}}),l&&window.removeEventListener("resize",l),l=h.bind(0,b),window.addEventListener("resize",l),l()},n.createdCallback=function(){a(this,"bin-packing-grid"),b(this,p),this.elements=this.elements||[],this.reflow()},document.registerElement("bin-packing-grid",{prototype:n}),o=Object.create(HTMLElement.prototype),q={top:{type:Number,observer:"change",value:0},left:{type:Number,observer:"change",value:0},cols:{type:Number,observer:"change",value:1},rows:{type:Number,observer:"change",value:1},baseSize:{type:Number,observer:"change",value:0},gutterSize:{type:Number,observer:"change",value:0}},o.change=function(){this.style.top=this.baseSize*this.top+"px",this.style.left=this.baseSize*this.left+"px",this.style.width=this.cols*this.baseSize-this.gutterSize+"px",this.style.height=this.rows*this.baseSize-this.gutterSize+"px"},o.attributeChangedCallback=function(){function a(a){var b,c;return b=a.split("-"),c=b.shift(),b=b.map(function(a){return a[0].toUpperCase()+a.slice(1)}).join(""),c+b}return function(b,c,d){q[b]&&(this[a(b)]=d)}}(),o.createdCallback=function(){var a,c,d;b(this,q),d=this,a=this.parentNode,null!==a&&(c=setInterval(function(){a.cellSize&&(clearInterval(c),d.gutterSize=a.gutterSize,d.baseSize=a.cellSize+a.gutterSize)},1))},document.registerElement("bin-packing-item",{prototype:o})}();</script>
</head><body></body></html>